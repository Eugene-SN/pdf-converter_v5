[2025-09-27T21:43:08.740+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: quality_assurance.load_translated_document manual__2025-09-27T21:43:07.574980+00:00 [queued]>
[2025-09-27T21:43:08.745+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: quality_assurance.load_translated_document manual__2025-09-27T21:43:07.574980+00:00 [queued]>
[2025-09-27T21:43:08.746+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-09-27T21:43:08.753+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): load_translated_document> on 2025-09-27 21:43:07.574980+00:00
[2025-09-27T21:43:08.758+0000] {standard_task_runner.py:60} INFO - Started process 468 to run task
[2025-09-27T21:43:08.760+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'quality_assurance', 'load_translated_document', 'manual__2025-09-27T21:43:07.574980+00:00', '--job-id', '925', '--raw', '--subdir', 'DAGS_FOLDER/quality_assurance.py', '--cfg-path', '/tmp/tmpy361imw_']
[2025-09-27T21:43:08.763+0000] {standard_task_runner.py:88} INFO - Job 925: Subtask load_translated_document
[2025-09-27T21:43:08.802+0000] {task_command.py:423} INFO - Running <TaskInstance: quality_assurance.load_translated_document manual__2025-09-27T21:43:07.574980+00:00 [running]> on host 5135eb910334
[2025-09-27T21:43:08.991+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='pdf-converter' AIRFLOW_CTX_DAG_ID='quality_assurance' AIRFLOW_CTX_TASK_ID='load_translated_document' AIRFLOW_CTX_EXECUTION_DATE='2025-09-27T21:43:07.574980+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-09-27T21:43:07.574980+00:00'
[2025-09-27T21:43:08.991+0000] {quality_assurance.py:328} INFO - 🔍 Начало полной 5-уровневой QA валидации
[2025-09-27T21:43:08.992+0000] {shared_utils.py:170} INFO - 📊 Метрики: {'dag_id': 'quality_assurance', 'task_id': 'load_translated_document', 'processing_time_seconds': 0.00029969215393066406, 'pages_processed': 0, 'file_size_mb': 0.0, 'success': True, 'timestamp': '2025-09-27T21:43:08.992193'}
[2025-09-27T21:43:08.992+0000] {quality_assurance.py:369} INFO - ✅ Документ загружен для полной QA: 13711 символов
[2025-09-27T21:43:08.992+0000] {python.py:201} INFO - Done. Returned value was: {'session_id': 'qa_full_1759009388', 'translated_file': '/app/output/zh/1759009195_test_short.md', 'translated_content': '# upload_1759009200_test_short\n\n## 命令列表\n\n| Command Name                                  | NetFn   | CMD   | Privilege   | 备注                                                                     |\n|-----------------------------------------------|---------|-------|-------------|--------------------------------------------------------------------------|\n| chassis status                                |         |       | User        | 获取当前服务器 (Server) 状态                                                   |\n| chassis restart_cause                         |         |       | User        | 获取服务器 (Server) 系统上次重启原因                                           |\n| chassis selftest                              |         |       | User        | 获取服务器 (Server) 系统自检结果                                               |\n| chassis policy always-on/previous/always-off  |         |       | operator    | 设置服务器 (Server) 系统电源 (Power Supply) 恢复策略为自动开机 / 恢复到断电前状态 / 保持关机状态 |\n| chassis bootdev {device}                      |         |       | operator    | 设置服务器 (Server) 的启动项                                                   |\n| power status                                  |         |       | User        | 获取服务器 (Server) 系统电源 (Power Supply) 当前状态                               |\n| power on/up                                   |         |       | operator    | 设置服务器 (Server) 开机                                                       |\n| power off/down                                |         |       | operator    | 设置服务器 (Server) 关机                                                       |\n| power reset                                   |         |       | operator    | 设置服务器 (Server) 重启                                                       |\n| mc info                                       |         |       | User        | 获取服务器 (Server) 管理系统各个模块信息                                       |\n| mc selftest                                   |         |       | User        | 获取服务器 (Server) 管理系统自检结果                                           |\n| mc reset cold                                 |         |       | Admin       | 设置服务器 (Server) 管理系统冷重启                                             |\n| sdr                                           |         |       | User        | 获取服务器 (Server) 所有传感器的部分信息                                         |\n| sensor list                                   |         |       | User        | 获取服务器 (Server) 所有传感器的详细参数信息                                     |\n| sensor get {sensor-name}                      |         |       | User        | 获取服务器 (Server) 指定传感器的详细信息                                         |\n| sensor thresh {sensor-name}                   |         |       | Admin       | 设置服务器 (Server) 指定传感器的阈值                                             |\n| sel                                           |         |       | User        | 获取系统日志信息                                                             |\n| sel elist                                     |         |       | User        | 获取系统详细日志记录                                                         |\n| fru                                           |         |       | User        | 获取现场可替换单元信息                                                       |\n| session info active                           |         |       | User        | 获取服务器 (Server) 管理系统当前活跃用户的会话信息                               |\n| User list                                     |         |       | User        | 获取所有用户信息                                                             |\n| User set name {User id} {Username}            |         |       | Admin       | 设置服务器 (Server) 管理系统新增用户名                                           |\n| User set password {User id} {password}        |         |       | Admin       | 设置服务器 (Server) 管理系统指定用户的密码                                       |\n| User test {User id} {16|20} {password}        |         |       | Admin       | 验证用户名密码的正确性                                                       |\n| User disable {User id}                        |         |       | Admin       | 关闭指定用户的服务器 (Server) 管理系统的访问权限                                 |\n| User enable {User id}                         |         |       | Admin       | 开启指定用户的服务器 (Server) 管理系统的访问权限                                 |\n| User priv {User id} {privilege level}         |         |       | Admin       | 设置指定用户的服务器 (Server) 管理系统访问权限                                   |\n\n## 用户权限管理\n\n### 用户权限操作命令\n\n| **命令**               | **权限级别** | **操作描述**                                                                 |\n|------------------------|--------------|------------------------------------------------------------------------------|\n| User disable {User id} | Admin        | 关闭指定用户的服务器 (Server)管理系统的访问权限                                 |\n| User enable {User id}  | Admin        | 开启指定用户的服务器 (Server)管理系统的访问权限                                 |\n| User priv {User id} {privilege level} | Admin        | 设置指定用户的服务器 (Server)管理系统访问权限                           |\n\n---\n\n## chassis selftest（获取服务器 (Server)系统自检结果）\n\n### 命令描述\n\n`chassis selftest` 命令用于获取服务器 (Server) 系统自检结果。\n\n| **属性**       | **说明**                                                                 |\n|----------------|--------------------------------------------------------------------------|\n| **权限级别**   | user                                                                     |\n| **命令示例**   | ```bash lenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus chassis selftest Self Test Results : passed ``` |\n\n---\n\n## chassis policy always-on/previous/always-off（设置服务器 (Server)系统电源 (Power Supply)恢复策略）\n\n### 命令描述\n\n`chassis policy` 命令用于设置服务器 (Server) 系统电源 (Power Supply) 恢复策略。支持以下三种策略：\n\n1. **always-on**：当服务器 (Server) 电源 (Power Supply) 接通后，系统会自动启动。\n2. **previous**：当服务器 (Server) 电源 (Power Supply) 接通后，系统恢复至电源 (Power Supply) 拔出前的状态。\n3. **always-off**：当服务器 (Server) 电源 (Power Supply) 接通后，系统保持关机状态。\n\n| **属性**       | **说明**                                                                 |\n|----------------|--------------------------------------------------------------------------|\n| **权限级别**   | operator                                                                |\n| **命令示例**   | ```bash lenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus chassis policy state <state>: list : return supported policies ``` |\n\n## chassis bootdev {device} （设置服务器 (Server) 的启动项）\n\n| Command Description   | chassis bootdev 命令用来设置服务器 (Server) 系统一次性启动选项。                                                                 |\n|-----------------------|-----------------------------------------------------------------------------------------------------------------------------------------|\n| Privilege             | operator                                                                                                                               |\n\n## sol activate （激活 SOL 功能）\n\n| Command Description   | sol activate 命令用来激活 SOL 功能。                                                                                                   |\n|-----------------------|-----------------------------------------------------------------------------------------------------------------------------------------|\n| Privilege             | administrator                                                                                                                         |\n| Command Example       | ```bash lenovo:~# ipmitool -H [BMC_IP] -U USERID -P PASSW0RD -I lanplus sol activate usesolkeepalive [SOL Session operational. Use ~? for help] ``` |\n\n## Command Example\n\n| Command Example       | `-H [BMC_IP] -U USERID -P PASSW0RD -I`                                                                                                  |\n|-----------------------|-----------------------------------------------------------------------------------------------------------------------------------------|\n|                       | ```bash lenovo:~# ipmitool lanplus chassis policy state <state>: list : return supported policies ``` |\n\n        |\n|------|---------------------------------------------------------------------------|\n| 1    | User ID (范围: `01h` 到 `05h`)                                           |\n| 2    | Parameter (具体含义见下表)                                                |\n\n#### Parameter Definitions\n\n| Parameter Value | Description                                                                 |\n|-----------------|-----------------------------------------------------------------------------|\n| `01h`           | 使能状态 (`00h` - 禁用, `01h` - 启用)                                     |\n| `02h`           | 严重性 (`01h` - 严重, `02h` - 严重和警告, `03h` - 全部)               |\n| `03h`           | 版本 (`01h` - v1, `02h` - v2c, `03h` - v3)                               |\n| `04h`           | 模式 (具体值取决于实现)                                                 |\n| `05h`           | 社区字符串 (长度: 17 字节)                                              |\n| `06h`           | 用户名 (长度: 17 字节)                                                  |\n| `07h`           | 用户加密状态 (`00h` - 加密, `01h` - 非加密)                             |\n| `08h`           | 密码 (长度: 17 字节)                                                    |\n| `09h`           | 密码加密状态 (`00h` - 加密, `01h` - 非加密)                             |\n| `0Ah`           | 目标 IP 地址 (长度: 33 字节)                                            |\n| `0Bh`           | 端口号 (长度: 3 字节)                                                   |\n| `0Ch`           | LAN 通道 (长度: 2 字节)                                                 |\n| `0Dh`           | 进入 ID (长度: 33 字节)                                                 |\n\n### Response Data Format\n\n| Parameter Value | Byte | Data Field                                                                 |\n|-----------------|------|---------------------------------------------------------------------------|\n| `01h`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `01h`           | 2    | 使能状态 (`00h` - 禁用, `01h` - 启用)                                 |\n| `02h`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `02h`           | 2    | 严重性 (`01h` - 严重, `02h` - 严重和警告, `03h` - 全部)             |\n| `03h`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `03h`           | 2    | 版本 (`01h` - v1, `02h` - v2c, `03h` - v3)                             |\n| `04h`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `04h`           | 2    | 模式 (具体值取决于实现)                                               |\n| `05h`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `05h`           | 2:17 | 社区字符串 (长度: 17 字节)                                            |\n| `06h`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `06h`           | 2:17 | 用户名 (长度: 17 字节)                                                |\n| `07h`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `07h`           | 2    | 用户加密状态 (`00h` - 加密, `01h` - 非加密)                           |\n| `08h`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `08h`           | 2:17 | 密码 (长度: 17 字节)                                                  |\n| `09h`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `09h`           | 2    | 密码加密状态 (`00h` - 加密, `01h` - 非加密)                           |\n| `0Ah`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `0Ah`           | 2:33 | 目标 IP 地址 (长度: 33 字节)                                          |\n| `0Bh`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `0Bh`           | 2:3  | 端口号 (长度: 3 字节)                                                 |\n| `0Ch`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `0Ch`           | 2    | LAN 通道 (长度: 2 字节)                                               |\n| `0Dh`           | 1    | 完成码 (`00h` - 成功, 其他值表示错误)                                 |\n| `0Dh`           | 2:33 | 进入 ID (长度: 33 字节)                                               |\n\n### Command Example\n\n```bash\n# ipmitool -H 10.109.107.160 -U USERID -P PASSW0RD raw 0x30 0x02 01\n```\n\n### Notes\n\n- 该命令用于获取或设置 SNMP Trap 相关配置信息。\n- 参数值的具体含义请参考上表。\n- 完成码 (`00h`) 表示命令执行成功，其他值表示错误，需根据具体错误码进行排查。\n\nASSW0RD` |\n|-------------------------------------------------------------------------|-------------------------------------------------------------------------|-------------------------------------------------------------------------|\n\n### SET SNMPTRAPINFO (netfn=`0x30`, cmd=`0x03`)\n\n| Byte | Data Field                                                                                                                                         |\n|------|----------------------------------------------------------------------------------------------------------------------------------------------------|\n| 1    | **User ID**: This value ranges from `01h` to `05h`.                                                                                               |\n| 2    | **Parameter** (values for different parameters):<br>`01h` - Enable<br>`02h` - Severity<br>`03h` - Version<br>`04h` - Mode<br>`05h` - Community<br>`06h` - User<br>`07h` - User Encrypt<br>`08h` - Password<br>`09h` - Pass Encrypt<br>`0Ah` - Destination IP<br>`0Bh` - Port<br>`0Ch` - LAN Channel<br>`0Dh` - Enter ID |\n| 3    | **Parameter Values**:<br>For parameter `01h` (Enable):<br>`00h` - Disable<br>`01h` - Enable<br>For parameter `02h` (Severity):<br>`01h` - Critical<br>`02h` - Critical and Warning<br>`03h` - All<br>For parameter `03h` (Version): |\n\n```markdown\n```', 'original_config': {'chinese_document': True, 'container_temp_dir': '/opt/***/temp', 'enable_ocr': True, 'extract_images': True, 'extract_tables': True, 'filename': 'test_short.pdf', 'input_dir': '/app/input', 'input_file': '/app/input/test_short.pdf', 'master_run_id': 'manual__2025-09-27T21:39:56.016696+00:00', 'output_target_dir': '/app/output/zh', 'output_zh_dir': '/app/output/zh', 'pipeline_version': '4.0_fixed', 'preserve_structure': True, 'preserve_technical_terms': True, 'processing_stages': 4, 'processing_start_time': '2025-09-27T21:39:56.951802', 'quality_level': 'high', 'quality_target': 100.0, 'stage_mode': 'full_conversion_with_validation', 'target_language': 'original', 'timestamp': 1759009195, 'translation_required': False, 'validation_enabled': True}, 'translation_metadata': {}, 'qa_start_time': '2025-09-27T21:43:08.992180', 'target_quality': 100.0, 'auto_correction': True, 'original_pdf_path': '/app/input/test_short.pdf', 'document_id': '1759009195_test_short', 'enable_5_level_validation': True, 'enterprise_mode': True, 'level_configs': {'level1_ocr': {'consensus_threshold': 0.85, 'similarity_threshold': 0.8, 'engines': ['paddleocr', 'tesseract']}, 'level2_visual': {'ssim_threshold': 0.95, 'difference_tolerance': 0.1, 'page_comparison_mode': 'structural', 'pandoc_integration': True}, 'level3_ast': {'structural_similarity_threshold': 0.9, 'semantic_similarity_threshold': 0.85, 'model_name': 'sentence-transformers/all-MiniLM-L6-v2'}, 'level4_content': {'min_technical_terms': 5, 'min_code_blocks': 1, 'formatting_score_threshold': 0.8}, 'level5_correction': {'vllm_endpoint': 'http://vllm:8000/v1/chat/completions', 'correction_model': 'Qwen/Qwen2.5-VL-32B-Instruct', 'max_retries': 3, 'enable_auto_correction': True}}, 'qa_rules': {'min_content_length': 100, 'min_headings': 1, 'max_chinese_chars_ratio': 0.3, 'require_title': True, 'check_table_structure': True, 'validate_markdown_syntax': True, 'technical_terms_check': True, 'preserve_brand_names': True, 'min_quality_score': 80.0, 'excellent_quality_score': 95.0, 'OCR_CONFIDENCE_THRESHOLD': 0.8, 'VISUAL_SIMILARITY_THRESHOLD': 0.95, 'AST_SIMILARITY_THRESHOLD': 0.9, 'SEMANTIC_SIMILARITY_THRESHOLD': 0.85, 'OVERALL_QA_THRESHOLD': 0.85, 'MAX_CORRECTIONS_PER_DOCUMENT': 10, 'AUTO_CORRECTION_CONFIDENCE': 0.7}}
[2025-09-27T21:43:09.013+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=quality_assurance, task_id=load_translated_document, execution_date=20250927T214307, start_date=20250927T214308, end_date=20250927T214309
[2025-09-27T21:43:09.053+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-09-27T21:43:09.076+0000] {taskinstance.py:3280} INFO - 3 downstream tasks scheduled from follow-on schedule check
