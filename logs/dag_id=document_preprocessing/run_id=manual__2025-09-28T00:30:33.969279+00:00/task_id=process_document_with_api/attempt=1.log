[2025-09-28T00:30:35.582+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: document_preprocessing.process_document_with_api manual__2025-09-28T00:30:33.969279+00:00 [queued]>
[2025-09-28T00:30:35.587+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: document_preprocessing.process_document_with_api manual__2025-09-28T00:30:33.969279+00:00 [queued]>
[2025-09-28T00:30:35.588+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 3
[2025-09-28T00:30:35.595+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): process_document_with_api> on 2025-09-28 00:30:33.969279+00:00
[2025-09-28T00:30:35.600+0000] {standard_task_runner.py:60} INFO - Started process 149 to run task
[2025-09-28T00:30:35.602+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'document_preprocessing', 'process_document_with_api', 'manual__2025-09-28T00:30:33.969279+00:00', '--job-id', '941', '--raw', '--subdir', 'DAGS_FOLDER/document_preprocessing.py', '--cfg-path', '/tmp/tmp4l6qwdns']
[2025-09-28T00:30:35.603+0000] {standard_task_runner.py:88} INFO - Job 941: Subtask process_document_with_api
[2025-09-28T00:30:35.644+0000] {task_command.py:423} INFO - Running <TaskInstance: document_preprocessing.process_document_with_api manual__2025-09-28T00:30:33.969279+00:00 [running]> on host 64801ed803bd
[2025-09-28T00:30:35.707+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='pdf-converter' AIRFLOW_CTX_DAG_ID='document_preprocessing' AIRFLOW_CTX_TASK_ID='process_document_with_api' AIRFLOW_CTX_EXECUTION_DATE='2025-09-28T00:30:33.969279+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-09-28T00:30:33.969279+00:00'
[2025-09-28T00:30:35.718+0000] {document_preprocessing.py:212} INFO - ğŸ”„ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ² document-processor API: http://document-processor:8001/process
[2025-09-28T00:30:35.719+0000] {document_preprocessing.py:244} INFO - ğŸ“¤ ĞŸĞ¾Ğ¿Ñ‹Ñ‚ĞºĞ° 1: Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ„Ğ°Ğ¹Ğ»Ğ° test_short.pdf Ñ Ğ¾Ğ¿Ñ†Ğ¸ÑĞ¼Ğ¸: {'extract_tables': True, 'extract_images': True, 'extract_formulas': True, 'use_ocr': True, 'ocr_languages': 'eng,chi_sim', 'high_quality_ocr': True, 'preserve_layout': True, 'enable_chunking': False}
[2025-09-28T00:30:55.174+0000] {document_preprocessing.py:367} INFO - âœ… Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½ Ğ¿Ğ¾Ğ»Ğ½Ğ¾Ñ†ĞµĞ½Ğ½Ñ‹Ğ¹ intermediate Ñ„Ğ°Ğ¹Ğ»: /opt/***/temp/doc_1759019435/doc_1759019435_intermediate.json
[2025-09-28T00:30:55.174+0000] {document_preprocessing.py:394} INFO - ğŸŒ‰ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½ bridge-Ñ„Ğ°Ğ¹Ğ»: /opt/***/temp/stage1_bridge_1759019430.json
[2025-09-28T00:30:55.175+0000] {shared_utils.py:170} INFO - ğŸ“Š ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸: {'dag_id': 'document_preprocessing', 'task_id': 'process_document_with_api', 'processing_time_seconds': 19.406296253204346, 'pages_processed': 5, 'file_size_mb': 0.0, 'success': True, 'timestamp': '2025-09-28T00:30:55.175129'}
[2025-09-28T00:30:55.175+0000] {document_preprocessing.py:435} INFO - âœ… Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ½ Ñ‡ĞµÑ€ĞµĞ· API Ğ·Ğ° 19.41Ñ
[2025-09-28T00:30:55.175+0000] {python.py:201} INFO - Done. Returned value was: {'success': True, 'document_info': {'title': 'test_short', 'total_pages': 5, 'processing_time': 19.406296253204346, 'status': 'success'}, 'intermediate_file': '/opt/***/temp/doc_1759019435/doc_1759019435_intermediate.json', 'original_config': {'chinese_document': True, 'chinese_optimization': True, 'enable_ocr': True, 'extract_images': True, 'extract_tables': True, 'filename': 'test_short.pdf', 'input_file': '/app/input/test_short.pdf', 'language': 'zh-CN', 'master_run_id': 'manual__2025-09-28T00:30:30.279758+00:00', 'output_mode': 'orchestrated', 'pipeline_version': '4.0_fixed', 'preserve_structure': True, 'processing_mode': 'chinese_optimized', 'processing_timeout': 1800, 'quality_level': 'high', 'temp_base_dir': '/opt/***/temp', 'timestamp': 1759019430, 'file_hash': '1325e2e9c02de90e5b98336a14e15da5', 'file_size_bytes': 481918, 'file_size_mb': 0.4595928192138672, 'estimated_pages': 4, 'has_chinese_text': False, 'recommended_ocr': True, 'processing_complexity': 'medium', 'chinese_doc_analysis': {'file_hash': '1325e2e9c02de90e5b98336a14e15da5', 'file_size_bytes': 481918, 'file_size_mb': 0.4595928192138672, 'estimated_pages': 4, 'has_chinese_text': False, 'recommended_ocr': True, 'processing_complexity': 'medium'}, 'validation_timestamp': '2025-09-28T00:30:34.663623'}, 'processing_stats': {'pages_processed': 5, 'ocr_used': True, 'processing_time_seconds': 19.406296253204346, 'tables_extracted': True, 'api_attempts': 1, 'ocr_fallback_used': False}, 'api_response': {'success': True, 'message': 'Document processed successfully', 'processing_time': 19.406296253204346, 'document_id': 'doc_1759019435', 'pages_count': 5, 'sections_count': 7, 'tables_count': 16, 'images_count': 0, 'formulas_count': 0, 'output_files': ['/app/temp/doc_1759019435/doc_1759019435_result.json', '/app/temp/doc_1759019435/doc_1759019435_intermediate.json'], 'metadata': {'original_file': '/app/temp/doc_1759019435/upload_1759019435_test_short.pdf', 'total_pages': 5, 'sections_count': 7, 'tables_count': 10, 'images_count': 0, 'chunks_count': 0, 'has_ocr_content': True, 'extraction_method': 'docling_v2', 'content_length': 337, 'section_titles': ['å‘½ä»¤åˆ—è¡¨', 'chassis selftest ï¼ˆè·å–æœåŠ¡å™¨ç³»ç»Ÿè‡ªæ£€ç»“æœï¼‰', 'chassis bootdev {device} ï¼ˆè®¾ç½®æœåŠ¡å™¨çš„å¯åŠ¨é¡¹ï¼‰', 'sol activate ï¼ˆæ¿€æ´» SOL åŠŸèƒ½ï¼‰', 'sol deactivate ï¼ˆå…³é—­ SOL åŠŸèƒ½ï¼‰', 'Get SNMP Trap Info ï¼ˆè·å– SNMP trap ä¿¡æ¯ï¼‰', 'Set SNMP Trap Info ï¼ˆè®¾ç½® SNMP trap ä¿¡æ¯ï¼‰'], 'outline_generated': True, 'processing_notes': [], 'structure_analysis': {'document_info': {'filename': 'upload_1759019435_test_short', 'total_pages': 7, 'total_text_blocks': 7, 'total_tables': 16, 'total_figures': 0, 'languages_detected': [], 'processing_methods': ['docling', 'docling']}, 'structure': {'headings': [{'text': 'å‘½ä»¤åˆ—è¡¨', 'page': 1, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}, {'text': 'chassis selftest ï¼ˆè·å–æœåŠ¡å™¨ç³»ç»Ÿè‡ªæ£€ç»“æœï¼‰', 'page': 2, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}, {'text': 'chassis bootdev {device} ï¼ˆè®¾ç½®æœåŠ¡å™¨çš„å¯åŠ¨é¡¹ï¼‰', 'page': 3, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}, {'text': 'sol activate ï¼ˆæ¿€æ´» SOL åŠŸèƒ½ï¼‰', 'page': 4, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}, {'text': 'sol deactivate ï¼ˆå…³é—­ SOL åŠŸèƒ½ï¼‰', 'page': 5, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}, {'text': 'Get SNMP Trap Info ï¼ˆè·å– SNMP trap ä¿¡æ¯ï¼‰', 'page': 6, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}, {'text': 'Set SNMP Trap Info ï¼ˆè®¾ç½® SNMP trap ä¿¡æ¯ï¼‰', 'page': 7, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}], 'paragraphs': [], 'lists': [], 'tables': [], 'figures': [], 'footnotes': [], 'headers_footers': []}, 'content_analysis': {'reading_order': [{'type': 'heading', 'text': 'å‘½ä»¤åˆ—è¡¨', 'page': 1, 'bbox': None, 'order_weight': 1}, {'type': 'heading', 'text': 'chassis selftest ï¼ˆè·å–æœåŠ¡å™¨ç³»ç»Ÿè‡ªæ£€ç»“æœï¼‰', 'page': 2, 'bbox': None, 'order_weight': 1}, {'type': 'heading', 'text': 'chassis bootdev {device} ï¼ˆè®¾ç½®æœåŠ¡å™¨çš„å¯åŠ¨é¡¹ï¼‰', 'page': 3, 'bbox': None, 'order_weight': 1}, {'type': 'heading', 'text': 'sol activate ï¼ˆæ¿€æ´» SOL åŠŸèƒ½ï¼‰', 'page': 4, 'bbox': None, 'order_weight': 1}, {'type': 'heading', 'text': 'sol deactivate ï¼ˆå…³é—­ SOL åŠŸèƒ½ï¼‰', 'page': 5, 'bbox': None, 'order_weight': 1}, {'type': 'heading', 'text': 'Get SNMP Trap Info ï¼ˆè·å– SNMP trap ä¿¡æ¯ï¼‰', 'page': 6, 'bbox': None, 'order_weight': 1}, {'type': 'heading', 'text': 'Set SNMP Trap Info ï¼ˆè®¾ç½® SNMP trap ä¿¡æ¯ï¼‰', 'page': 7, 'bbox': None, 'order_weight': 1}], 'logical_sections': [{'title': 'å‘½ä»¤åˆ—è¡¨', 'level': 2, 'page_start': 1, 'page_end': 1, 'elements': [{'type': 'heading', 'data': {'text': 'å‘½ä»¤åˆ—è¡¨', 'page': 1, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}}]}, {'title': 'chassis selftest ï¼ˆè·å–æœåŠ¡å™¨ç³»ç»Ÿè‡ªæ£€ç»“æœï¼‰', 'level': 2, 'page_start': 2, 'page_end': 2, 'elements': [{'type': 'heading', 'data': {'text': 'chassis selftest ï¼ˆè·å–æœåŠ¡å™¨ç³»ç»Ÿè‡ªæ£€ç»“æœï¼‰', 'page': 2, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}}]}, {'title': 'chassis bootdev {device} ï¼ˆè®¾ç½®æœåŠ¡å™¨çš„å¯åŠ¨é¡¹ï¼‰', 'level': 2, 'page_start': 3, 'page_end': 3, 'elements': [{'type': 'heading', 'data': {'text': 'chassis bootdev {device} ï¼ˆè®¾ç½®æœåŠ¡å™¨çš„å¯åŠ¨é¡¹ï¼‰', 'page': 3, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}}]}, {'title': 'sol activate ï¼ˆæ¿€æ´» SOL åŠŸèƒ½ï¼‰', 'level': 2, 'page_start': 4, 'page_end': 4, 'elements': [{'type': 'heading', 'data': {'text': 'sol activate ï¼ˆæ¿€æ´» SOL åŠŸèƒ½ï¼‰', 'page': 4, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}}]}, {'title': 'sol deactivate ï¼ˆå…³é—­ SOL åŠŸèƒ½ï¼‰', 'level': 2, 'page_start': 5, 'page_end': 5, 'elements': [{'type': 'heading', 'data': {'text': 'sol deactivate ï¼ˆå…³é—­ SOL åŠŸèƒ½ï¼‰', 'page': 5, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}}]}, {'title': 'Get SNMP Trap Info ï¼ˆè·å– SNMP trap ä¿¡æ¯ï¼‰', 'level': 2, 'page_start': 6, 'page_end': 6, 'elements': [{'type': 'heading', 'data': {'text': 'Get SNMP Trap Info ï¼ˆè·å– SNMP trap ä¿¡æ¯ï¼‰', 'page': 6, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}}]}, {'title': 'Set SNMP Trap Info ï¼ˆè®¾ç½® SNMP trap ä¿¡æ¯ï¼‰', 'level': 2, 'page_start': 7, 'page_end': 7, 'elements': [{'type': 'heading', 'data': {'text': 'Set SNMP Trap Info ï¼ˆè®¾ç½® SNMP trap ä¿¡æ¯ï¼‰', 'page': 7, 'bbox': None, 'type': 'heading', 'level': 2, 'source': 'docling'}}]}], 'cross_references': [], 'document_outline': []}, 'quality_metrics': {'text_extraction_confidence': 0.9, 'structure_detection_confidence': 0.8, 'table_extraction_quality': 0.7}}}, 'intermediate_file': '/app/temp/doc_1759019435/doc_1759019435_intermediate.json', 'ocr_used': True, 'docling_version': '2.0+'}, 'output_files': ['/app/temp/doc_1759019435/doc_1759019435_result.json', '/app/temp/doc_1759019435/doc_1759019435_intermediate.json']}
[2025-09-28T00:30:55.200+0000] {taskinstance.py:1138} INFO - Marking task as SUCCESS. dag_id=document_preprocessing, task_id=process_document_with_api, execution_date=20250928T003033, start_date=20250928T003035, end_date=20250928T003055
[2025-09-28T00:30:55.214+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 0
[2025-09-28T00:30:55.235+0000] {taskinstance.py:3280} INFO - 1 downstream tasks scheduled from follow-on schedule check
