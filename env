# ================================================================================
# PDF CONVERTER PIPELINE v2.0 - –ü–û–õ–ù–û–°–¢–¨–Æ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
# ‚úÖ –í–°–ï –ù–ï–î–û–°–¢–ê–Æ–©–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –î–û–ë–ê–í–õ–ï–ù–´
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–´ –ù–ê–ó–í–ê–ù–ò–Ø –ú–û–î–ï–õ–ï–ô vLLM  
# ‚úÖ –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–´ –ù–ê–°–¢–†–û–ô–ö–ò –î–õ–Ø PRODUCTION
# ================================================================================

# ================================================================================
# üîß –û–°–ù–û–í–ù–ê–Ø –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
# ================================================================================
PROJECT_VERSION=2.0
ENVIRONMENT=production

# –ü—É—Ç–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
BASE_PATH=/mnt/storage/docker/pdf-converter
HF_HOME=/mnt/storage/models/huggingface
PADDLEX_HOME=/mnt/storage/models/paddlex
DOCLING_HOME=/mnt/storage/models/docling
HF_CACHE_HOME=/mnt/storage/models/docling/huggingface
VLLM_CACHE=/mnt/storage/models/vllm_cache
TRANSFORMERS_CACHE=${HF_HOME}/transformers_cache
HF_HUB_CACHE=${HF_HOME}/hub_cache
HF_MODULES_CACHE=${HF_HOME}/modules_cache
TRITON_CACHE_DIR=${HF_HOME}/triton_cache
PADDLEOCR_HOME=/mnt/storage/models/paddleocr
DOCLING_MODEL_PATH=/mnt/storage/models/docling

# ================================================================================
# ü§ñ vLLM –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
# ================================================================================
VLLM_SERVER_URL=http://vllm-server:8000

VLLM_CONTENT_MODEL=Qwen/Qwen2.5-VL-32B-Instruct
VLLM_TRANSLATION_MODEL=Qwen/Qwen3-30B-A3B-Instruct-2507

# –î–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å docker-compose
VLLM_MODEL_NAME=${VLLM_CONTENT_MODEL}

# –¢–∞–π–º-–∞—É—Ç—ã (—Å–µ–∫—É–Ω–¥—ã)
VLLM_STANDARD_TIMEOUT=1800
VLLM_MODEL_SWITCH_TIMEOUT=300

# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è 2x A6000 (48GB total)
VLLM_TENSOR_PARALLEL_SIZE=2
VLLM_PIPELINE_PARALLEL_SIZE=1
VLLM_GPU_MEMORY_UTILIZATION=0.85
VLLM_MAX_MODEL_LEN=4096
VLLM_MAX_NUM_SEQS=16
VLLM_BLOCK_SIZE=16

# Dynamic model loading
DYNAMIC_MODEL_LOADING=true
MODEL_SWAP_TIMEOUT=300
AUTO_MODEL_SELECTION=true

# API –∫–ª—é—á
VLLM_API_KEY=pdf-converter-secure-key-2024
VLLM_MAX_TOKENS=4096
VLLM_TEMPERATURE=0.1

DISABLE_THINKING=true

# ================================================================================
# üì° –ú–ï–ñ–°–ï–†–í–ò–°–ù–´–ï URL (‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û!)
# ================================================================================
AIRFLOW_BASE_URL=http://airflow-webserver:8090
DOCUMENT_PROCESSOR_URL=http://document-processor:8001
QUALITY_ASSURANCE_URL=http://quality-assurance:8002
TRANSLATOR_URL=http://translator:8003

# URL –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ —Å —Ö–æ—Å—Ç–∞
VLLM_SERVER_URL_HOST=http://localhost:8000
DOCUMENT_PROCESSOR_URL_HOST=http://localhost:8001
QUALITY_ASSURANCE_URL_HOST=http://localhost:8002
TRANSLATOR_URL_HOST=http://localhost:8003
AIRFLOW_BASE_URL_HOST=http://localhost:8090

# ================================================================================
# üåä AIRFLOW –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø (‚úÖ –í–°–ï –ù–ï–î–û–°–¢–ê–Æ–©–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –î–û–ë–ê–í–õ–ï–ù–´)
# ================================================================================
AIRFLOW_UID=1000
AIRFLOW_GID=0
PROJ_DIR=.

_AIRFLOW_WWW_USER_USERNAME=admin
_AIRFLOW_WWW_USER_PASSWORD=admin

AIRFLOW__API__AUTH_BACKENDS=airflow.api.auth.backend.basic_auth,airflow.api.auth.backend.session
AIRFLOW__WEBSERVER__BASE_URL=http://10.255.100.200:8090
AIRFLOW__WEBSERVER__EXPOSE_CONFIG=true

# ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û: –°–∏–ª—å–Ω—ã–µ –∫–ª—é—á–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
AIRFLOW__CORE__FERNET_KEY=UKMzEm3yIuFYEq1y3-2FxPNWSVwRASpahmQ9kQfEr8Q=
AIRFLOW_SECRET_KEY=2FxPNWSVwRASpahmQ9kQfEr8Q=
AIRFLOW__WEBSERVER__SECRET_KEY=${AIRFLOW_SECRET_KEY}

AIRFLOW__CORE__SECURITY=True
AIRFLOW__API__ENABLE_EXPERIMENTAL_API=False

# Executor
AIRFLOW__CORE__EXECUTOR=CeleryExecutor
AIRFLOW__CELERY__BROKER_URL=redis://redis:6379/0
AIRFLOW__CELERY__RESULT_BACKEND=db+postgresql://airflow:airflow@postgres/airflow
AIRFLOW__CELERY__BROKER_CONNECTION_RETRY_ON_STARTUP=true
AIRFLOW__WEBSERVER__ENABLE_SWAGGER_UI=false

AIRFLOW__CORE__DAGS_ARE_PAUSED_AT_CREATION=false
AIRFLOW__CORE__LOAD_EXAMPLES=false

# ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û: –í—Å–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ Airflow –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ –ª–æ–≥–æ–≤
AIRFLOW__METRICS__STATSD_ON=false
AIRFLOW__METRICS__STATSD_HOST=statsd-exporter
AIRFLOW__METRICS__STATSD_PORT=9125
AIRFLOW__METRICS__STATSD_PREFIX=airflow
AIRFLOW__METRICS__METRICS_ALLOW_LIST=
AIRFLOW__METRICS__METRICS_BLOCK_LIST=

AIRFLOW__CORE__METRICS_USE_PATTERN_MATCH=false
AIRFLOW__CORE__MAX_ACTIVE_RUNS_PER_DAG=8
AIRFLOW__CORE__MAX_ACTIVE_TASKS_PER_DAG=64
AIRFLOW__CORE__DAGBAG_IMPORT_TIMEOUT=1200
AIRFLOW__CORE__PARALLELISM=128

AIRFLOW__LOGGING__LOGGING_LEVEL=INFO
AIRFLOW__WEBSERVER__LOGGING_LEVEL=INFO
AIRFLOW__WEBSERVER__WEB_SERVER_WORKER_TIMEOUT=1200

AIRFLOW__CELERY__WORKER_CONCURRENCY=16
AIRFLOW__CELERY__OPERATION_TIMEOUT=21600

AIRFLOW__DATABASE__SQL_ALCHEMY_POOL_SIZE=100
AIRFLOW__DATABASE__SQL_ALCHEMY_POOL_RECYCLE=3600
AIRFLOW__DATABASE__SQL_ALCHEMY_POOL_PRE_PING=true

_PIP_ADDITIONAL_REQUIREMENTS=

# ================================================================================
# üìù PDF PROCESSING (‚úÖ –í–°–ï –ù–ï–î–û–°–¢–ê–Æ–©–ò–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –î–û–ë–ê–í–õ–ï–ù–´)
# ================================================================================
DEFAULT_EXTRACT_TABLES=true
DEFAULT_EXTRACT_IMAGES=true
DEFAULT_USE_OCR=false
CREATE_SEPARATE_FOLDERS=true
EMBED_IMAGES_IN_MD=false
DEFAULT_LANGUAGE=original
DEFAULT_MODEL_SIZE=large

# ================================================================================
# üõ†Ô∏è FLASK API –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
# ================================================================================
FLASK_SECRET_KEY=your_super_secret_key_here_change_in_production
FLASK_ENV=production
FLASK_DEBUG=false
MAX_CONTENT_LENGTH=1073741824

# ================================================================================
# üìÅ –î–ò–†–ï–ö–¢–û–†–ò–ò –î–õ–Ø –û–ë–†–ê–ë–û–¢–ö–ò (‚úÖ –î–û–ë–ê–í–õ–ï–ù TEMP_FOLDER)
# ================================================================================
INPUT_DIR=/app/input
OUTPUT_DIR=/app/output
TEMP_DIR=/app/temp

UPLOAD_FOLDER=/app/input_pdf
OUTPUT_FOLDER_ZH=/app/output/zh
OUTPUT_FOLDER_RU=/app/output/ru
OUTPUT_FOLDER_EN=/app/output/en
TEMP_FOLDER=/app/temp

# ================================================================================
# üóÉÔ∏è POSTGRESQL –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏)
# ================================================================================
POSTGRES_DB=airflow
POSTGRES_USER=airflow
POSTGRES_PASSWORD=airflow123

# ‚úÖ –û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–û: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å PostgreSQL
POSTGRES_SHARED_BUFFERS=8GB
POSTGRES_EFFECTIVE_CACHE_SIZE=24GB
POSTGRES_MAINTENANCE_WORK_MEM=2GB
POSTGRES_WAL_BUFFERS=64MB
POSTGRES_CHECKPOINT_COMPLETION_TARGET=0.9
POSTGRES_DEFAULT_STATISTICS_TARGET=500
POSTGRES_RANDOM_PAGE_COST=1.1
POSTGRES_EFFECTIVE_IO_CONCURRENCY=200
POSTGRES_WORK_MEM=256MB
POSTGRES_MAX_CONNECTIONS=200

# ================================================================================
# üìä REDIS –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø
# ================================================================================
REDIS_MAXMEMORY=8GB
REDIS_MAXMEMORY_POLICY=allkeys-lru

# ================================================================================
# üìà GRAFANA –ú–û–ù–ò–¢–û–†–ò–ù–ì
# ================================================================================
GF_SECURITY_ADMIN_PASSWORD=admin

# ================================================================================
# ‚öôÔ∏è –°–ï–†–í–ò–°–ù–´–ï –ü–ê–†–ê–ú–ï–¢–†–´ (‚úÖ –í–°–ï –ù–ï–î–û–°–¢–ê–Æ–©–ò–ï –î–û–ë–ê–í–õ–ï–ù–´)
# ================================================================================

# Document Processor
PADDLEOCR_USE_GPU=true
PADDLEOCR_LANG=en,ch,ru
PADDLEOCR_USE_TEXTLINE_ORIENTATION=true
DOCLING_USE_GPU=true
DOCLING_MAX_WORKERS=4
OCR_CONFIDENCE_THRESHOLD=0.8
MAX_FILE_SIZE_MB=500
PROCESSING_TIMEOUT_MINUTES=60
TESSERACT_CONFIG="--oem 3 --psm 6"

# Quality Assurance
QA_ENABLED=true
QA_THRESHOLD=0.95
AUTO_CORRECTION_ENABLED=true
MAX_CORRECTIONS_PER_DOCUMENT=5
AST_COMPARISON_ENABLED=true
SSIM_THRESHOLD=0.95
VISUAL_DIFF_TOLERANCE=0.05
OCR_CROSS_VALIDATION=true

# Translator
SERVICE_PORT=8003
ENABLE_CACHING=true
CACHE_SIZE_LIMIT=1000
PRESERVE_TECHNICAL_TERMS=true
REQUEST_TIMEOUT=300
INTER_REQUEST_DELAY=0.1

# ================================================================================
# üîç –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ –ò –ë–ê–¢–ß–ò–ù–ì
# ================================================================================
BATCH_SIZE_HEADERS=4
BATCH_SIZE_TABLES=3
BATCH_SIZE_COMMANDS=2
BATCH_SIZE_TEXT=6
BATCH_SIZE_MIXED=4

# ================================================================================
# üìù –õ–û–ì–ò–†–û–í–ê–ù–ò–ï –ò –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨
# ================================================================================
LOG_LEVEL=INFO
VERBOSE_PROGRESS=true
SHOW_STATISTICS=true
SHOW_DETAILED_PROGRESS=true
LOG_ERRORS=true

MAX_REMAINING_FIXES=20
REMAINING_TIMEOUT=300
MAX_FIX_ATTEMPTS=2
MIN_FRAGMENT_LENGTH=2
CREATE_BACKUP=true

# ================================================================================
# üöÄ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò
# ================================================================================

# Timeout'—ã –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
DOCLING_PROCESSING_TIMEOUT=3600
OCR_PROCESSING_TIMEOUT=1800
TRANSLATION_TIMEOUT=1200
QA_VALIDATION_TIMEOUT=600

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
MAX_CONCURRENT_DOCUMENTS=4
MAX_PAGES_PER_DOCUMENT=500
MAX_PROCESSING_MEMORY_GB=32

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
ENABLE_MODEL_CACHING=true
MODEL_CACHE_SIZE_GB=16
CLEAR_CACHE_ON_RESTART=false

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
ENABLE_PERFORMANCE_MONITORING=true
ALERT_ON_HIGH_MEMORY_USAGE=true
MEMORY_ALERT_THRESHOLD_PERCENT=85
DISK_ALERT_THRESHOLD_PERCENT=90

# ================================================================================
# üõ°Ô∏è –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨ –ò –î–û–°–¢–£–ü
# ================================================================================

# API Keys
API_SECRET_KEY=your_api_secret_key_change_in_production
WEBHOOK_SECRET=your_webhook_secret_change_in_production

# Rate limiting
ENABLE_RATE_LIMITING=true
MAX_REQUESTS_PER_MINUTE=60
MAX_CONCURRENT_UPLOADS=10

# File validation
ALLOWED_FILE_EXTENSIONS=pdf
SCAN_UPLOADED_FILES=true
QUARANTINE_SUSPICIOUS_FILES=true

# ================================================================================
# üì° –ò–ù–¢–ï–ì–†–ê–¶–ò–ò –ò –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø
# ================================================================================

# Webhook URLs (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
SUCCESS_WEBHOOK_URL=
ERROR_WEBHOOK_URL=
MONITORING_WEBHOOK_URL=

# Slack –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
SLACK_WEBHOOK_URL=
SLACK_CHANNEL=#pdf-converter-alerts

# Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
SMTP_SERVER=
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
NOTIFICATION_EMAIL=

# ================================================================================
# üîß –û–¢–õ–ê–î–ö–ê –ò –†–ê–ó–†–ê–ë–û–¢–ö–ê
# ================================================================================

# –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏
DEBUG_MODE=false
VERBOSE_LOGGING=false
ENABLE_PROFILING=false

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
ENABLE_MOCK_SERVICES=false
SIMULATE_PROCESSING_DELAY=false
TEST_MODE=false

# –†–∞–∑—Ä–∞–±–æ—Ç—á–µ—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
AUTO_RELOAD_ON_CHANGE=false
ENABLE_DEVELOPMENT_ENDPOINTS=false
BYPASS_AUTHENTICATION=false